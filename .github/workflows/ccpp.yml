name: C++ CI

on: 
    workflow_dispatch:
    push:
    repository_dispatch:
        types: [linux-compile-test, install-test]
jobs:
  build:

    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v1
    - name: prep
      run: sudo apt-get install -y hmmer ncbi-blast+ git libcurl4-openssl-dev build-essential curl
    - name: make
      run: make
    - name: version
      run: |
          cat version.txt
          ./amrfinder --version
    - name: download db
      run: ./amrfinder -u
    - name: make test
      run: make test
